<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES6 特性示例</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #4CAF50;
            margin-top: 30px;
        }
        
        h3 {
            color: #2196F3;
            margin-top: 25px;
        }
        
        .concept {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }
        
        .example {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        code {
            display: block;
            background-color: #f1f1f1;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 15px 0;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .output {
            margin-top: 15px;
            padding: 15px;
            background-color: #e8f5e9;
            border-left: 4px solid #4CAF50;
            border-radius: 4px;
        }
        
        .error {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            color: #c62828;
        }
        
        .explanation {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 4px 4px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ES6 常用特性详解</h1>
        
        <div class="concept">
            <h2>JavaScript 作用域概念</h2>
            <p><strong>全局作用域：</strong>在代码任何地方都能访问的变量，通常在函数外部声明。</p>
            <p><strong>函数作用域：</strong>在函数内部声明的变量，只能在该函数内部访问。</p>
            <p><strong>块级作用域：</strong>ES6 引入的概念，用 {} 包裹的代码块内声明的变量，只能在该代码块内访问。</p>
        </div>
        
        <div class="example">
            <h2>1. let、const 和 var 的区别</h2>
            <p><strong>概念：</strong>ES6 引入了 let 和 const 来声明变量，它们与 var 的主要区别在于作用域和行为。</p>
            <ul>
                <li>var 声明的变量具有函数作用域，没有块级作用域</li>
                <li>let 和 const 声明的变量具有块级作用域</li>
                <li>const 声明的是常量，一旦赋值就不能再修改</li>
            </ul>
            
            <button onclick="runVarExample()">运行 var 示例</button>
            <button onclick="runLetExample()">运行 let 示例</button>
            <button onclick="runConstExample()">运行 const 示例</button>
            <div id="varLetConstOutput"></div>
        </div>
        
        <div class="example">
            <h2>2. 箭头函数 (Arrow Functions)</h2>
            <p><strong>概念：</strong>箭头函数是ES6引入的一种更简洁的函数定义方式，它不仅语法更简短，还具有词法绑定的this特性。</p>
            <ul>
                <li>当函数体只有一行表达式时，会自动返回该表达式的结果（无需显式写return）</li>
                <li>当函数体包含多条语句时，需要用大括号{}包裹，并显式使用return语句</li>
                <li>当箭头函数需要返回对象字面量时，必须用括号()包裹对象，否则会被解析为函数体的大括号</li>
            </ul>
            <button onclick="runArrowFunctionExample()">运行箭头函数示例</button>
            <div id="arrowFunctionOutput"></div>
            <br>
        </div>
        
        <div class="example">
            <h2>3. 模板字符串</h2>
            <p>使用反引号(`)和${}语法，可以更方便地拼接字符串。</p>
            <code>
// ES5 字符串拼接
var name = '李四';
var age = 25;
var messageES5 = '我叫' + name + '，今年' + age + '岁';

// ES6 模板字符串
const messageES6 = `我叫${name}，今年${age}岁`;
console.log(messageES6); // 我叫李四，今年25岁
            </code>
            <button onclick="runTemplateStringExample()">运行模板字符串示例</button>
            <div id="templateStringOutput"></div>
        </div>
        
        <div class="example">
            <h2>4. 解构赋值</h2>
            <p>可以从数组或对象中提取值并赋给变量。</p>
            <code>
// 数组解构
const colors = ['red', 'green', 'blue'];
const [first, second] = colors;
console.log(first);  // red
console.log(second); // green

// 对象解构
const person = { name: '王五', age: 30 };
const { name, age } = person;
console.log(name); // 王五
console.log(age);  // 30
            </code>
            <button onclick="runDestructuringExample()">运行解构赋值示例</button>
            <div id="destructureOutput"></div>
        </div>
        
        <div class="example">
            <h2>5. Promise</h2>
            <p>用于处理异步操作，避免回调地狱。</p>
            <code>
// ES5 回调方式 (可能出现回调地狱)
// getData(function(a) {
//     getMoreData(a, function(b) {
//         getEvenMoreData(b, function(c) {
//             // ...
//         });
//     });
// });

// ES6 Promise 方式
function fetchData() {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            const success = true;
            if (success) {
                resolve('数据获取成功');
            } else {
                reject('数据获取失败');
            }
        }, 1000);
    });
}

// 使用Promise
fetchData()
    .then(result => console.log(result))
    .catch(error => console.log(error));
            </code>
            <button onclick="runPromiseExample()">运行Promise示例</button>
            <div id="promiseOutput"></div>
        </div>
        
        <div class="example">
            <h2>6. 类 (Class)</h2>
            <p>ES6提供了类的语法糖，使面向对象编程更直观。</p>
            <code>
// ES5 构造函数方式
function PersonES5(name, age) {
    this.name = name;
    this.age = age;
}
PersonES5.prototype.sayHello = function() {
    return `你好，我是${this.name}`;
};

// ES6 类语法
class PersonES6 {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    sayHello() {
        return `你好，我是${this.name}`;
    }
}

// 使用
const person1 = new PersonES6('赵六', 28);
console.log(person1.sayHello()); // 你好，我是赵六
            </code>
            <button onclick="runClassExample()">运行类示例</button>
            <div id="classOutput"></div>
        </div>
    </div>

    <script>
        // var/let/const示例的执行函数
        function runVarExample() {
            const output = document.getElementById('varLetConstOutput');
            try {
                // 模拟ES5 var的行为
                function varExample() {
                    if (true) {
                        var a = 1;
                    }
                    return a; // var没有块级作用域，可以访问到
                }
                
                const result = varExample();
                output.innerHTML = `var示例结果: ${result} (var没有块级作用域，变量可以在if块外部访问)`;
                output.className = 'output';
            } catch (error) {
                output.innerHTML = `var示例错误: ${error.message}`;
                output.className = 'output error';
            }
        }
        
        function runLetExample() {
            const output = document.getElementById('varLetConstOutput');
            try {
                // 模拟ES6 let的行为
                function letExample() {
                    if (true) {
                        let b = 2;
                    }
                    return b; // let有块级作用域，这里访问不到b
                }
                
                const result = letExample();
                output.innerHTML = `let示例结果: ${result}`;
                output.className = 'output error';
            } catch (error) {
                output.innerHTML = `let示例错误: ${error.message} (let有块级作用域，变量只能在if块内部访问)`;
                output.className = 'output error';
            }
        }
        
        function runConstExample() {
            const output = document.getElementById('varLetConstOutput');
            try {
                // 模拟ES6 const的行为
                const PI = 3.14159;
                PI = 3.14; // 尝试修改常量
                output.innerHTML = `const示例结果: ${PI}`;
                output.className = 'output';
            } catch (error) {
                output.innerHTML = `const示例错误: ${error.message} (const声明的常量不能被重新赋值)`;
                output.className = 'output error';
            }
        }
        
        // 箭头函数示例的执行函数
        function runArrowFunctionExample() {
            const output = document.getElementById('arrowFunctionOutput');
            
            // 情况1：直接返回表达式结果（自动return）
            const add = (a, b) => a + b;
            const result1 = add(2, 3);
            
            // 情况2：函数体包含多条语句（需要显式return）
            const multiply = (a, b) => {
                const product = a * b;
                return product * 2;
            };
            const result2 = multiply(2, 3);
            
            // 情况3：返回对象字面量（需要用括号包裹）
            // 如果不加括号，JavaScript会把{}解析为函数体的大括号，导致语法错误
            const func3 = () => ({ name: '张三', age: 25 });
            const result3 = func3();
            
            // 错误示例：不加括号会报错
            // const func3Error = () => { name: '张三', age: 25 }; // SyntaxError
            
            output.innerHTML = `
                <p><strong>箭头函数示例结果：</strong></p>
                <p>1. 简单表达式返回: add(2, 3) = ${result1}</p>
                <p>2. 多语句显式返回: multiply(2, 3) = ${result2}</p>
                <p>3. 返回对象字面量: func3() = ${JSON.stringify(result3)}</p>
                <p><strong>说明：</strong>箭头函数返回对象字面量时必须用括号()包裹，因为JavaScript解析器会将开头的{解释为函数体的开始，而不是对象的开始。</p>
            `;
        }
        
        // 模板字符串示例的执行函数
        function runTemplateStringExample() {
            const output = document.getElementById('templateStringOutput');
            
            // ES5 字符串拼接
            var name = '李四';
            var age = 25;
            var messageES5 = '我叫' + name + '，今年' + age + '岁';
            
            // ES6 模板字符串
            const messageES6 = `我叫${name}，今年${age}岁`;
            
            output.innerHTML = `
                <p><strong>模板字符串示例结果：</strong></p>
                <p>ES5字符串拼接: ${messageES5}</p>
                <p>ES6模板字符串: ${messageES6}</p>
                <p>两者结果相同，但模板字符串语法更简洁易读</p>
            `;
            output.className = 'output';
        }
        
        // 解构赋值示例的执行函数
        function runDestructuringExample() {
            const output = document.getElementById('destructureOutput');
            
            // 数组解构
            const colors = ['red', 'green', 'blue'];
            const [first, second] = colors;
            
            // 对象解构
            const person = { name: '王五', age: 30 };
            const { name, age } = person;
            
            output.innerHTML = `
                <p><strong>解构赋值示例结果：</strong></p>
                <p>数组解构: first = ${first}, second = ${second}</p>
                <p>对象解构: name = ${name}, age = ${age}</p>
                <p>解构赋值让我们能更方便地从数组或对象中提取值</p>
            `;
            output.className = 'output';
        }
        
        // Promise示例的执行函数
        function runPromiseExample() {
            const output = document.getElementById('promiseOutput');
            
            // ES6 Promise 方式
            function fetchData() {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        const success = true;
                        if (success) {
                            resolve('数据获取成功');
                        } else {
                            reject('数据获取失败');
                        }
                    }, 1000);
                });
            }
            
            output.innerHTML = '<p>Promise示例正在执行，请等待1秒...</p>';
            output.className = 'output';
            
            // 使用Promise
            fetchData()
                .then(result => {
                    output.innerHTML = `<p><strong>Promise执行成功:</strong> ${result}</p>`;
                    output.className = 'output';
                })
                .catch(error => {
                    output.innerHTML = `<p><strong>Promise执行失败:</strong> ${error}</p>`;
                    output.className = 'output error';
                });
        }
        
        // 类示例的执行函数
        function runClassExample() {
            const output = document.getElementById('classOutput');
            
            // ES5 构造函数方式
            function PersonES5(name, age) {
                this.name = name;
                this.age = age;
            }
            PersonES5.prototype.sayHello = function() {
                return `你好，我是${this.name}`;
            };
            
            // ES6 类语法
            class PersonES6 {
                constructor(name, age) {
                    this.name = name;
                    this.age = age;
                }
                
                sayHello() {
                    return `你好，我是${this.name}`;
                }
            }
            
            // 使用
            const person1 = new PersonES6('赵六', 28);
            
            output.innerHTML = `
                <p><strong>类示例结果：</strong></p>
                <p>ES6类语法: ${person1.sayHello()}</p>
                <p>类是ES6提供的语法糖，使面向对象编程更直观</p>
            `;
            output.className = 'output';
        }
    </script>
</body>
</html>