# 德州扑克游戏

一个功能完整的单机德州扑克游戏，支持玩家与两个AI对手进行对战，实现完整的游戏流程和智能AI决策系统。

## 项目特色

### 🎮 完整的游戏体验
- **自动开始**: 页面加载后1秒自动开始游戏
- **随机位置分配**: 玩家随机分配到1-3号位置
- **智能AI对手**: 两个具有不同个性的CPU对手
- **完整游戏流程**: 翻牌前→翻牌→转牌→河牌→摊牌

### 🤖 智能AI系统
- **个性差异化**: 激进型和平衡型两种AI个性
- **智能决策**: 基于手牌强度、底池赔率和玩家行为
- **真实行为模拟**: 包含诈唬、过牌、加注等策略
- **3秒思考时间**: 模拟真实玩家的决策过程

### 🎯 专业游戏机制
- **正确的行动顺序**: 1→2→3号玩家轮流行动
- **完整下注回合**: 支持Pre-flop、Flop、Turn、River四个阶段
- **智能按钮管理**: 仅当前玩家回合启用操作按钮
- **筹码系统**: 完整的下注、跟注、加注、弃牌机制

## 游戏功能

### 核心功能
- ✅ **自动游戏开始**: 无需手动点击开始
- ✅ **随机位置分配**: 每次游戏随机分配玩家位置
- ✅ **完整行动顺序**: 1→2→3号玩家轮流行动
- ✅ **人类玩家无限时间**: 玩家有充足时间决策
- ✅ **CPU智能行动**: 3秒自动决策，模拟真实思考
- ✅ **完整游戏阶段**: Pre-flop → Flop → Turn → River → Showdown
- ✅ **智能按钮状态**: 仅当前玩家回合启用相应按钮

### 操作功能
- **下注 (Bet)**: 主动下注指定金额
- **过牌 (Check)**: 当前无人下注时选择过牌
- **跟注 (Call)**: 跟注当前最高下注额
- **弃牌 (Fold)**: 放弃当前手牌
- **加注 (Raise)**: 在跟注基础上增加下注

### AI个性类型
1. **激进型AI**: 倾向于加注和诈唬
2. **平衡型AI**: 根据牌力做出合理决策

## 技术实现

### 文件结构
```
德扑/
├── index.html          # 菜单页面
├── game.html           # 游戏主页面
├── styles.css          # 样式文件
├── script.js           # 菜单页面逻辑
├── poker.js            # 扑克牌逻辑核心
├── game.js             # 游戏主逻辑（最新修复版）
└── README.md           # 项目说明文档
```

### 核心模块

#### `poker.js` - 扑克牌逻辑
- 牌型评估和比较算法
- 从7张牌中找出最佳5张牌组合
- 专业的牌型识别系统

#### `game.js` - 游戏主逻辑（最新修复）
- **游戏状态管理**: 完整的游戏流程控制
- **玩家行动系统**: 1→2→3轮流行动机制
- **AI决策引擎**: 智能CPU对手行为模拟
- **阶段推进逻辑**: 自动推进游戏阶段
- **按钮状态管理**: 智能启用/禁用操作按钮

### 关键技术特性

#### 游戏进程控制
```javascript
// 正确的行动顺序控制
function processPlayerTurn() {
    if (currentPlayerIndex === humanPlayerPosition) {
        // 人类玩家回合 - 启用按钮
        updateButtonStates(true);
    } else {
        // CPU玩家回合 - 3秒后自动行动
        setTimeout(cpuPlayerAction, 3000);
    }
}
```

#### 智能按钮管理
```javascript
function updateButtonStates(isHumanTurn) {
    if (isHumanTurn && !currentPlayer.folded) {
        // 仅人类玩家回合且未弃牌时启用按钮
        betBtn.disabled = false;
        checkBtn.disabled = false;
        // ... 其他按钮
    } else {
        // 禁用所有按钮
        betBtn.disabled = true;
        checkBtn.disabled = true;
        // ... 其他按钮
    }
}
```

#### 阶段推进系统
```javascript
function advanceToNextStage() {
    switch (gameState.currentStage) {
        case 'PREFLOP':
            // 发Flop牌并进入Flop阶段
            break;
        case 'FLOP':
            // 发Turn牌并进入Turn阶段
            break;
        case 'TURN':
            // 发River牌并进入River阶段
            break;
        case 'RIVER':
            // 进入摊牌阶段
            determineWinner();
            break;
    }
}
```

## 游戏流程

### 1. 游戏初始化
- 页面加载后1秒自动开始游戏
- 随机分配玩家位置（1/2/3号）
- 扣除底注，开始Pre-flop阶段

### 2. 行动顺序
- **1号玩家**行动 → **2号玩家**行动 → **3号玩家**行动
- 人类玩家：无限时间决策
- CPU玩家：3秒自动行动
- 弃牌玩家跳过后续行动

### 3. 游戏阶段推进
1. **Pre-flop**: 发玩家手牌，第一轮下注
2. **Flop**: 发3张公共牌，第二轮下注
3. **Turn**: 发第4张公共牌，第三轮下注
4. **River**: 发第5张公共牌，最后一轮下注
5. **Showdown**: 摊牌比较，决定胜负

### 4. 游戏结束
- 显示获胜玩家和牌型
- 结算筹码
- 准备新一轮游戏

## 快速开始

### 运行游戏
1. 打开 `index.html` 文件进入菜单页面
2. 点击"开始游戏"按钮
3. 游戏自动开始（1秒后）
4. 根据提示进行游戏操作

### 游戏操作指南
1. **您的回合时**: 操作按钮会启用，选择相应操作
2. **CPU回合时**: 等待3秒，观察AI决策
3. **下注策略**: 根据手牌强度和对手行为做出决策
4. **观察学习**: 注意AI的行为模式，提高自己的游戏水平

### 键盘快捷键
- `1` 或 `B`: 下注
- `2` 或 `C`: 过牌
- `3` 或 `L`: 跟注
- `4` 或 `R`: 加注
- `5` 或 `F`: 弃牌
- `Enter`: 确认下注
- `Escape`: 取消下注

## 开发特性

### 最新修复内容
- ✅ 修复游戏自动开始问题
- ✅ 实现正确的玩家行动顺序
- ✅ 优化CPU行动时间控制
- ✅ 完善游戏阶段推进逻辑
- ✅ 改进按钮状态管理
- ✅ 修复语法错误和逻辑问题

## 技术栈
- **前端**: HTML5, CSS3, JavaScript (ES6+)
- **游戏逻辑**: 纯JavaScript实现
- **样式**: 自定义CSS，赌桌风格设计
- **存储**: localStorage 数据持久化

## 浏览器兼容性
- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 贡献指南
欢迎提交Issue和Pull Request来改进游戏！

## 许可证
MIT License

---

**享受您的德州扑克游戏体验！** 🃏